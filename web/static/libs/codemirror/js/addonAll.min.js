!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t){return"pairs"==t&&"string"==typeof e?e:"object"==typeof e&&null!=e[t]?e[t]:u[t]}function n(e){var t=e.state.closeBrackets;return!t||t.override?t:e.getModeAt(e.getCursor()).closeBrackets||t}function o(o){var r=n(o);if(!r||o.getOption("disableInput"))return e.Pass;for(var i=t(r,"pairs"),a=o.listSelections(),s=0;s<a.length;s++){if(!a[s].empty())return e.Pass;var l=c(o,a[s].head);if(!l||i.indexOf(l)%2!=0)return e.Pass}for(s=a.length-1;s>=0;s--){var f=a[s].head;o.replaceRange("",d(f.line,f.ch-1),d(f.line,f.ch+1),"+delete")}}function r(o){var r=n(o),i=r&&t(r,"explode");if(!i||o.getOption("disableInput"))return e.Pass;for(var a=o.listSelections(),s=0;s<a.length;s++){if(!a[s].empty())return e.Pass;var l=c(o,a[s].head);if(!l||i.indexOf(l)%2!=0)return e.Pass}o.operation(function(){o.replaceSelection("\n\n",null),o.execCommand("goCharLeft"),a=o.listSelections();for(var e=0;e<a.length;e++){var t=a[e].head.line;o.indentLine(t,null,!0),o.indentLine(t+1,null,!0)}})}function i(t){var n=e.cmpPos(t.anchor,t.head)>0;return{anchor:new d(t.anchor.line,t.anchor.ch+(n?-1:1)),head:new d(t.head.line,t.head.ch+(n?1:-1))}}function a(o,r){var a=n(o);if(!a||o.getOption("disableInput"))return e.Pass;var c=t(a,"pairs"),u=c.indexOf(r);if(-1==u)return e.Pass;for(var h,p=t(a,"triples"),g=c.charAt(u+1)==r,m=o.listSelections(),v=u%2==0,y=0;y<m.length;y++){var b,x=m[y],C=x.head,M=o.getRange(C,d(C.line,C.ch+1));if(v&&!x.empty())b="surround";else if(!g&&v||M!=r)if(g&&C.ch>1&&p.indexOf(r)>=0&&o.getRange(d(C.line,C.ch-2),C)==r+r&&(C.ch<=2||o.getRange(d(C.line,C.ch-3),d(C.line,C.ch-2))!=r))b="addFour";else if(g){if(e.isWordChar(M)||!l(o,C,r))return e.Pass;b="both"}else{if(!v||o.getLine(C.line).length!=C.ch&&!s(M,c)&&!/\s/.test(M))return e.Pass;b="both"}else b=g&&f(o,C)?"both":p.indexOf(r)>=0&&o.getRange(C,d(C.line,C.ch+3))==r+r+r?"skipThree":"skip";if(h){if(h!=b)return e.Pass}else h=b}var T=u%2?c.charAt(u-1):r,k=u%2?r:c.charAt(u+1);o.operation(function(){if("skip"==h)o.execCommand("goCharRight");else if("skipThree"==h)for(t=0;t<3;t++)o.execCommand("goCharRight");else if("surround"==h){for(var e=o.getSelections(),t=0;t<e.length;t++)e[t]=T+e[t]+k;o.replaceSelections(e,"around"),e=o.listSelections().slice();for(t=0;t<e.length;t++)e[t]=i(e[t]);o.setSelections(e)}else"both"==h?(o.replaceSelection(T+k,null),o.triggerElectric(T+k),o.execCommand("goCharLeft")):"addFour"==h&&(o.replaceSelection(T+T+T+T,"before"),o.execCommand("goCharRight"))})}function s(e,t){var n=t.lastIndexOf(e);return n>-1&&n%2==1}function c(e,t){var n=e.getRange(d(t.line,t.ch-1),d(t.line,t.ch+1));return 2==n.length?n:null}function l(t,n,o){var r=t.getLine(n.line),i=t.getTokenAt(n);if(/\bstring2?\b/.test(i.type)||f(t,n))return!1;var a=new e.StringStream(r.slice(0,n.ch)+o+r.slice(n.ch),4);for(a.pos=a.start=i.start;;){var s=t.getMode().token(a,i.state);if(a.pos>=n.ch+1)return/\bstring2?\b/.test(s);a.start=a.pos}}function f(e,t){var n=e.getTokenAt(d(t.line,t.ch+1));return/\bstring/.test(n.type)&&n.start==t.ch}var u={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},d=e.Pos;e.defineOption("autoCloseBrackets",!1,function(t,n,o){o&&o!=e.Init&&(t.removeKeyMap(p),t.state.closeBrackets=null),n&&(t.state.closeBrackets=n,t.addKeyMap(p))});for(var h=u.pairs+"`",p={Backspace:o,Enter:r},g=0;g<h.length;g++)p["'"+h.charAt(g)+"'"]=function(e){return function(t){return a(t,e)}}(h.charAt(g))}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){function t(t){if(t.getOption("disableInput"))return e.Pass;for(var n=t.listSelections(),o=[],c=0;c<n.length;c++){if(!n[c].empty())return e.Pass;var l=n[c].head,f=t.getTokenAt(l),u=e.innerMode(t.getMode(),f.state),d=u.state;if("xml"!=u.mode.name||!d.tagName)return e.Pass;var h=t.getOption("autoCloseTags"),p="html"==u.mode.configuration,g="object"==typeof h&&h.dontCloseTags||p&&a,m="object"==typeof h&&h.indentTags||p&&s,v=d.tagName;f.end>l.ch&&(v=v.slice(0,v.length-f.end+l.ch));var y=v.toLowerCase();if(!v||"string"==f.type&&(f.end!=l.ch||!/[\"\']/.test(f.string.charAt(f.string.length-1))||1==f.string.length)||"tag"==f.type&&"closeTag"==d.type||f.string.indexOf("/")==f.string.length-1||g&&r(g,y)>-1||i(t,v,l,d,!0))return e.Pass;var b=m&&r(m,y)>-1;o[c]={indent:b,text:">"+(b?"\n\n":"")+"</"+v+">",newPos:b?e.Pos(l.line+1,0):e.Pos(l.line,l.ch+1)}}for(c=n.length-1;c>=0;c--){var x=o[c];t.replaceRange(x.text,n[c].head,n[c].anchor,"+insert");var C=t.listSelections().slice(0);C[c]={head:x.newPos,anchor:x.newPos},t.setSelections(C),x.indent&&(t.indentLine(x.newPos.line,null,!0),t.indentLine(x.newPos.line+1,null,!0))}}function n(t,n){for(var o=t.listSelections(),r=[],a=n?"/":"</",s=0;s<o.length;s++){if(!o[s].empty())return e.Pass;var c=o[s].head,l=t.getTokenAt(c),f=e.innerMode(t.getMode(),l.state),u=f.state;if(n&&("string"==l.type||"<"!=l.string.charAt(0)||l.start!=c.ch-1))return e.Pass;var d;if("xml"!=f.mode.name)if("htmlmixed"==t.getMode().name&&"javascript"==f.mode.name)d=a+"script";else{if("htmlmixed"!=t.getMode().name||"css"!=f.mode.name)return e.Pass;d=a+"style"}else{if(!u.context||!u.context.tagName||i(t,u.context.tagName,c,u))return e.Pass;d=a+u.context.tagName}">"!=t.getLine(c.line).charAt(l.end)&&(d+=">"),r[s]=d}t.replaceSelections(r),o=t.listSelections();for(s=0;s<o.length;s++)(s==o.length-1||o[s].head.line<o[s+1].head.line)&&t.indentLine(o[s].head.line)}function o(t){return t.getOption("disableInput")?e.Pass:n(t,!0)}function r(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;++n)if(e[n]==t)return n;return-1}function i(t,n,o,r,i){if(!e.scanForClosingTag)return!1;var a=Math.min(t.lastLine()+1,o.line+500),s=e.scanForClosingTag(t,o,null,a);if(!s||s.tag!=n)return!1;for(var c=r.context,l=i?1:0;c&&c.tagName==n;c=c.prev)++l;o=s.to;for(var f=1;f<l;f++){var u=e.scanForClosingTag(t,o,null,a);if(!u||u.tag!=n)return!1;o=u.to}return!0}e.defineOption("autoCloseTags",!1,function(n,r,i){if(i!=e.Init&&i&&n.removeKeyMap("autoCloseTags"),r){var a={name:"autoCloseTags"};("object"!=typeof r||r.whenClosing)&&(a["'/'"]=function(e){return o(e)}),("object"!=typeof r||r.whenOpening)&&(a["'>'"]=function(e){return t(e)}),n.addKeyMap(a)}});var a=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],s=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];e.commands.closeTag=function(e){return n(e)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var t=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,n=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,o=/[*+-]\s/;e.commands.newlineAndIndentContinueMarkdownList=function(r){if(r.getOption("disableInput"))return e.Pass;for(var i=r.listSelections(),a=[],s=0;s<i.length;s++){var c=i[s].head,l=r.getStateAfter(c.line),f=!1!==l.list,u=0!==l.quote,d=r.getLine(c.line),h=t.exec(d);if(!i[s].empty()||!f&&!u||!h)return void r.execCommand("newlineAndIndent");if(n.test(d))/>\s*$/.test(d)||r.replaceRange("",{line:c.line,ch:0},{line:c.line,ch:c.ch+1}),a[s]="\n";else{var p=h[1],g=h[5],m=o.test(h[2])||h[2].indexOf(">")>=0?h[2].replace("x"," "):parseInt(h[3],10)+1+h[4];a[s]="\n"+p+m+g}}r.replaceSelections(a)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,o){var r=e.getLineHandle(t.line),i=t.ch-1,c=o&&o.afterCursor;null==c&&(c=/(^| )cm-fat-cursor($| )/.test(e.getWrapperElement().className));var l=!c&&i>=0&&s[r.text.charAt(i)]||s[r.text.charAt(++i)];if(!l)return null;var f=">"==l.charAt(1)?1:-1;if(o&&o.strict&&f>0!=(i==t.ch))return null;var u=e.getTokenTypeAt(a(t.line,i+1)),d=n(e,a(t.line,i+(f>0?1:0)),f,u||null,o);return null==d?null:{from:a(t.line,i),to:d&&d.pos,match:d&&d.ch==l.charAt(0),forward:f>0}}function n(e,t,n,o,r){for(var i=r&&r.maxScanLineLength||1e4,c=r&&r.maxScanLines||1e3,l=[],f=r&&r.bracketRegex?r.bracketRegex:/[(){}[\]]/,u=n>0?Math.min(t.line+c,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-c),d=t.line;d!=u;d+=n){var h=e.getLine(d);if(h){var p=n>0?0:h.length-1,g=n>0?h.length:-1;if(!(h.length>i))for(d==t.line&&(p=t.ch-(n<0?1:0));p!=g;p+=n){var m=h.charAt(p);if(f.test(m)&&(void 0===o||e.getTokenTypeAt(a(d,p+1))==o))if(">"==s[m].charAt(1)==n>0)l.push(m);else{if(!l.length)return{pos:a(d,p),ch:m};l.pop()}}}}return d-n!=(n>0?e.lastLine():e.firstLine())&&null}function o(e,n,o){for(var r=e.state.matchBrackets.maxHighlightLineLength||1e3,s=[],c=e.listSelections(),l=0;l<c.length;l++){var f=c[l].empty()&&t(e,c[l].head,o);if(f&&e.getLine(f.from.line).length<=r){var u=f.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";s.push(e.markText(f.from,a(f.from.line,f.from.ch+1),{className:u})),f.to&&e.getLine(f.to.line).length<=r&&s.push(e.markText(f.to,a(f.to.line,f.to.ch+1),{className:u}))}}if(s.length){i&&e.state.focused&&e.focus();var d=function(){e.operation(function(){for(var e=0;e<s.length;e++)s[e].clear()})};if(!n)return d;setTimeout(d,800)}}function r(e){e.operation(function(){c&&(c(),c=null),c=o(e,!1,e.state.matchBrackets)})}var i=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),a=e.Pos,s={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},c=null;e.defineOption("matchBrackets",!1,function(t,n,o){o&&o!=e.Init&&(t.off("cursorActivity",r),c&&(c(),c=null)),n&&(t.state.matchBrackets="object"==typeof n?n:{},t.on("cursorActivity",r))}),e.defineExtension("matchBrackets",function(){o(this,!0)}),e.defineExtension("findMatchingBracket",function(e,n,o){return(o||"boolean"==typeof n)&&(o?(o.strict=n,n=o):n=n?{strict:!0}:null),t(this,e,n)}),e.defineExtension("scanForBracket",function(e,t,o,r){return n(this,e,t,o,r)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){"use strict";function t(e){e.state.tagHit&&e.state.tagHit.clear(),e.state.tagOther&&e.state.tagOther.clear(),e.state.tagHit=e.state.tagOther=null}function n(n){n.state.failedTagMatch=!1,n.operation(function(){if(t(n),!n.somethingSelected()){var o=n.getCursor(),r=n.getViewport();r.from=Math.min(r.from,o.line),r.to=Math.max(o.line+1,r.to);var i=e.findMatchingTag(n,o,r);if(i){if(n.state.matchBothTags){var a="open"==i.at?i.open:i.close;a&&(n.state.tagHit=n.markText(a.from,a.to,{className:"CodeMirror-matchingtag"}))}var s="close"==i.at?i.open:i.close;s?n.state.tagOther=n.markText(s.from,s.to,{className:"CodeMirror-matchingtag"}):n.state.failedTagMatch=!0}}})}function o(e){e.state.failedTagMatch&&n(e)}e.defineOption("matchTags",!1,function(r,i,a){a&&a!=e.Init&&(r.off("cursorActivity",n),r.off("viewportChange",o),t(r)),i&&(r.state.matchBothTags="object"==typeof i&&i.bothTags,r.on("cursorActivity",n),r.on("viewportChange",o),n(r))}),e.commands.toMatchingTag=function(t){var n=e.findMatchingTag(t,t.getCursor());if(n){var o="close"==n.at?n.open:n.close;o&&t.extendSelection(o.to,o.from)}}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.defineOption("showTrailingSpace",!1,function(t,n,o){o==e.Init&&(o=!1),o&&!n?t.removeOverlay("trailingspace"):!o&&n&&t.addOverlay({token:function(e){for(var t=e.string.length,n=t;n&&/\s/.test(e.string.charAt(n-1));--n);return n>e.pos?(e.pos=n,null):(e.pos=t,"trailingspace")},name:"trailingspace"})})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,n){var o;return o=e.getWrapperElement().appendChild(document.createElement("div")),o.className=n?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top","string"==typeof t?o.innerHTML=t:o.appendChild(t),o}function n(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}e.defineExtension("openDialog",function(o,r,i){function a(e){if("string"==typeof e)u.value=e;else{if(l)return;l=!0,c.parentNode.removeChild(c),f.focus(),i.onClose&&i.onClose(c)}}i||(i={}),n(this,null);var s,c=t(this,o,i.bottom),l=!1,f=this,u=c.getElementsByTagName("input")[0];return u?(u.focus(),i.value&&(u.value=i.value,!1!==i.selectValueOnOpen&&u.select()),i.onInput&&e.on(u,"input",function(e){i.onInput(e,u.value,a)}),i.onKeyUp&&e.on(u,"keyup",function(e){i.onKeyUp(e,u.value,a)}),e.on(u,"keydown",function(t){i&&i.onKeyDown&&i.onKeyDown(t,u.value,a)||((27==t.keyCode||!1!==i.closeOnEnter&&13==t.keyCode)&&(u.blur(),e.e_stop(t),a()),13==t.keyCode&&r(u.value,t))}),!1!==i.closeOnBlur&&e.on(u,"blur",a)):(s=c.getElementsByTagName("button")[0])&&(e.on(s,"click",function(){a(),f.focus()}),!1!==i.closeOnBlur&&e.on(s,"blur",a),s.focus()),a}),e.defineExtension("openConfirm",function(o,r,i){function a(){l||(l=!0,s.parentNode.removeChild(s),f.focus())}n(this,null);var s=t(this,o,i&&i.bottom),c=s.getElementsByTagName("button"),l=!1,f=this,u=1;c[0].focus();for(var d=0;d<c.length;++d){var h=c[d];!function(t){e.on(h,"click",function(n){e.e_preventDefault(n),a(),t&&t(f)})}(r[d]),e.on(h,"blur",function(){--u,setTimeout(function(){u<=0&&a()},200)}),e.on(h,"focus",function(){++u})}}),e.defineExtension("openNotification",function(o,r){function i(){c||(c=!0,clearTimeout(a),s.parentNode.removeChild(s))}n(this,i);var a,s=t(this,o,r&&r.bottom),c=!1,l=r&&void 0!==r.duration?r.duration:5e3;return e.on(s,"click",function(t){e.e_preventDefault(t),i()}),l&&(a=setTimeout(i,l)),i})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return"string"==typeof e?e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t?"gi":"g"):e.global||(e=new RegExp(e.source,e.ignoreCase?"gi":"g")),{token:function(t){e.lastIndex=t.pos;var n=e.exec(t.string);if(n&&n.index==t.pos)return t.pos+=n[0].length||1,"searching";n?t.pos=n.index:t.skipToEnd()}}}function n(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null}function o(e){return e.state.search||(e.state.search=new n)}function r(e){return"string"==typeof e&&e==e.toLowerCase()}function i(e,t,n){return e.getSearchCursor(t,n,{caseFold:r(t),multiline:!0})}function a(e,t,n,o,r){e.openDialog(t,o,{value:n,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){p(e)},onKeyDown:r})}function s(e,t,n,o,r){e.openDialog?e.openDialog(t,r,{value:o,selectValueOnOpen:!0}):r(prompt(n,o))}function c(e,t,n,o){e.openConfirm?e.openConfirm(t,o):confirm(n)&&o[0]()}function l(e){return e.replace(/\\(.)/g,function(e,t){return"n"==t?"\n":"r"==t?"\r":t})}function f(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);if(t)try{e=new RegExp(t[1],-1==t[2].indexOf("i")?"":"i")}catch(e){}else e=l(e);return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e}function u(e,n,o){n.queryText=o,n.query=f(o),e.removeOverlay(n.overlay,r(n.query)),n.overlay=t(n.query,r(n.query)),e.addOverlay(n.overlay),e.showMatchesOnScrollbar&&(n.annotate&&(n.annotate.clear(),n.annotate=null),n.annotate=e.showMatchesOnScrollbar(n.query,r(n.query)))}function d(t,n,r,i){var c=o(t);if(c.query)return h(t,n);var l=t.getSelection()||c.lastQuery;if(r&&t.openDialog){var f=null,d=function(n,o){e.e_stop(o),n&&(n!=c.queryText&&(u(t,c,n),c.posFrom=c.posTo=t.getCursor()),f&&(f.style.opacity=1),h(t,o.shiftKey,function(e,n){var o;n.line<3&&document.querySelector&&(o=t.display.wrapper.querySelector(".CodeMirror-dialog"))&&o.getBoundingClientRect().bottom-4>t.cursorCoords(n,"window").top&&((f=o).style.opacity=.4)}))};a(t,v,l,d,function(n,r){var i=e.keyName(n),a=e.keyMap[t.getOption("keyMap")][i];a||(a=t.getOption("extraKeys")[i]),"findNext"==a||"findPrev"==a||"findPersistentNext"==a||"findPersistentPrev"==a?(e.e_stop(n),u(t,o(t),r),t.execCommand(a)):"find"!=a&&"findPersistent"!=a||(e.e_stop(n),d(r,n))}),i&&l&&(u(t,c,l),h(t,n))}else s(t,v,"Search for:",l,function(e){e&&!c.query&&t.operation(function(){u(t,c,e),c.posFrom=c.posTo=t.getCursor(),h(t,n)})})}function h(t,n,r){t.operation(function(){var a=o(t),s=i(t,a.query,n?a.posFrom:a.posTo);(s.find(n)||(s=i(t,a.query,n?e.Pos(t.lastLine()):e.Pos(t.firstLine(),0))).find(n))&&(t.setSelection(s.from(),s.to()),t.scrollIntoView({from:s.from(),to:s.to()},20),a.posFrom=s.from(),a.posTo=s.to(),r&&r(s.from(),s.to()))})}function p(e){e.operation(function(){var t=o(e);t.lastQuery=t.query,t.query&&(t.query=t.queryText=null,e.removeOverlay(t.overlay),t.annotate&&(t.annotate.clear(),t.annotate=null))})}function g(e,t,n){e.operation(function(){for(var o=i(e,t);o.findNext();)if("string"!=typeof t){var r=e.getRange(o.from(),o.to()).match(t);o.replace(n.replace(/\$(\d)/g,function(e,t){return r[t]}))}else o.replace(n)})}function m(e,t){if(!e.getOption("readOnly")){var n=e.getSelection()||o(e).lastQuery,r='<span class="CodeMirror-search-label">'+(t?"Replace all:":"Replace:")+"</span>";s(e,r+y,r,n,function(n){n&&(n=f(n),s(e,b,"Replace with:","",function(o){if(o=l(o),t)g(e,n,o);else{p(e);var r=i(e,n,e.getCursor("from")),a=function(){var t,l=r.from();!(t=r.findNext())&&(r=i(e,n),!(t=r.findNext())||l&&r.from().line==l.line&&r.from().ch==l.ch)||(e.setSelection(r.from(),r.to()),e.scrollIntoView({from:r.from(),to:r.to()}),c(e,x,"Replace?",[function(){s(t)},a,function(){g(e,n,o)}]))},s=function(e){r.replace("string"==typeof n?o:o.replace(/\$(\d)/g,function(t,n){return e[n]})),a()};a()}}))})}}var v='<span class="CodeMirror-search-label">Search:</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',y=' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',b='<span class="CodeMirror-search-label">With:</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',x='<span class="CodeMirror-search-label">Replace?</span> <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>';e.commands.find=function(e){p(e),d(e)},e.commands.findPersistent=function(e){p(e),d(e,!1,!0)},e.commands.findPersistentNext=function(e){d(e,!1,!0,!0)},e.commands.findPersistentPrev=function(e){d(e,!0,!0,!0)},e.commands.findNext=d,e.commands.findPrev=function(e){d(e,!0)},e.commands.clearSearch=p,e.commands.replace=m,e.commands.replaceAll=function(e){m(e,!0)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){function n(e){clearTimeout(o.doRedraw),o.doRedraw=setTimeout(function(){o.redraw()},e)}this.cm=e,this.options=t,this.buttonHeight=t.scrollButtonHeight||e.getOption("scrollButtonHeight"),this.annotations=[],this.doRedraw=this.doUpdate=null,this.div=e.getWrapperElement().appendChild(document.createElement("div")),this.div.style.cssText="position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none",this.computeScale();var o=this;e.on("refresh",this.resizeHandler=function(){clearTimeout(o.doUpdate),o.doUpdate=setTimeout(function(){o.computeScale()&&n(20)},100)}),e.on("markerAdded",this.resizeHandler),e.on("markerCleared",this.resizeHandler),!1!==t.listenForChanges&&e.on("change",this.changeHandler=function(){n(250)})}e.defineExtension("annotateScrollbar",function(e){return"string"==typeof e&&(e={className:e}),new t(this,e)}),e.defineOption("scrollButtonHeight",0),t.prototype.computeScale=function(){var e=this.cm,t=(e.getWrapperElement().clientHeight-e.display.barHeight-2*this.buttonHeight)/e.getScrollerElement().scrollHeight;if(t!=this.hScale)return this.hScale=t,!0},t.prototype.update=function(e){this.annotations=e,this.redraw()},t.prototype.redraw=function(e){function t(e,t){return c!=e.line&&(c=e.line,l=n.getLineHandle(c)),l.widgets&&l.widgets.length||a&&l.height>s?n.charCoords(e,"local")[t?"top":"bottom"]:n.heightAtLine(l,"local")+(t?0:l.height)}!1!==e&&this.computeScale();var n=this.cm,o=this.hScale,r=document.createDocumentFragment(),i=this.annotations,a=n.getOption("lineWrapping"),s=a&&1.5*n.defaultTextHeight(),c=null,l=null,f=n.lastLine();if(n.display.barWidth)for(var u,d=0;d<i.length;d++){var h=i[d];if(!(h.to.line>f)){for(var p=u||t(h.from,!0)*o,g=t(h.to,!1)*o;d<i.length-1&&!(i[d+1].to.line>f)&&!((u=t(i[d+1].from,!0)*o)>g+.9);)g=t((h=i[++d]).to,!1)*o;if(g!=p){var m=Math.max(g-p,3),v=r.appendChild(document.createElement("div"));v.style.cssText="position: absolute; right: 0px; width: "+Math.max(n.display.barWidth-1,2)+"px; top: "+(p+this.buttonHeight)+"px; height: "+m+"px",v.className=this.options.className,h.id&&v.setAttribute("annotation-id",h.id)}}}this.div.textContent="",this.div.appendChild(r)},t.prototype.clear=function(){this.cm.off("refresh",this.resizeHandler),this.cm.off("markerAdded",this.resizeHandler),this.cm.off("markerCleared",this.resizeHandler),this.changeHandler&&this.cm.off("change",this.changeHandler),this.div.parentNode.removeChild(this.div)}});